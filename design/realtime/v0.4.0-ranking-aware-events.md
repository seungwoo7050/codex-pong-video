# v0.4.0 랭크 구분 실시간 이벤트 설계

## 1. 목적
- WebSocket 이벤트에 경기 종류(일반/랭크)를 포함해 프런트가 랭크 UI를 구분하도록 한다.
- 랭크전 종료 시 레이팅 변동 정보를 함께 전달해 즉시 알림을 표시한다.

## 2. 이벤트 포맷
- 엔드포인트: `/ws/game?roomId=<id>&token=<jwt>`
- 서버 메시지(`GameServerMessage`):
  ```json
  {
    "type": "READY" | "STATE" | "FINISHED",
    "snapshot": { ... },
    "matchType": "NORMAL" | "RANKED",
    "ratingChange": {
      "winnerId": number | null,
      "winnerDelta": number,
      "loserId": number | null,
      "loserDelta": number
    } | null
  }
  ```
- `ratingChange`는 랭크전 종료 시에만 포함되며, 무승부이면 `winnerId/loserId`가 null이고 delta는 0에 가까운 값이다.

## 3. 흐름
1. 클라이언트가 roomId/token으로 연결 → READY 메시지에서 `matchType` 확인 후 UI 상태 업데이트.
2. 틱마다 STATE 메시지 전송, `matchType`은 방 생성 시 지정된 값을 유지.
3. 종료 시 마지막 STATE와 함께 `ratingChange`를 포함해 브로드캐스트 후 방 삭제.

## 4. 프런트 처리 지침
- `useGameSocket`에서 `matchType`, `ratingChange`를 상태로 저장.
- 게임 화면에서 `matchType === 'RANKED'`일 때만 레이팅 변동 안내를 노출.
- 일반전에서는 `ratingChange`가 null이므로 UI가 간소화된다.

## 5. 테스트 포인트
- 랭크전 WebSocket 스트림에서 READY/STATE에 `matchType: RANKED`가 포함되는지 확인.
- 종료 시 `ratingChange`가 전달되고, 값이 User ID와 매칭되는지 확인.
