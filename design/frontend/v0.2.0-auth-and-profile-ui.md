# v0.2.0 프론트엔드 설계 - 인증/프로필 UI

## 1. 목표와 범위
- 로그인/회원가입 화면을 제공하고 JWT 기반 인증 상태를 SPA 전역에서 관리한다.
- 내 프로필 화면에서 닉네임/아바타를 조회·수정한다.
- 보호된 라우트를 적용해 인증되지 않은 사용자가 주요 기능에 접근하지 못하도록 한다.
- WebSocket 연결 시 토큰을 전달해 백엔드 인증 핸드셰이크와 연동한다.

## 2. 주요 화면/플로우
- 로그인 페이지: 아이디/비밀번호 입력, 실패 시 한국어 에러 메시지, 회원가입 링크 제공.
- 회원가입 페이지: 아이디/비밀번호/닉네임/아바타 URL 입력, 성공 시 자동 로그인 및 프로필 화면 이동.
- 내 프로필 페이지: 기본 정보(아이디, 생성/수정 시각) 표시, 닉네임/아바타 수정 후 저장.
- 로비/게임 페이지: `ProtectedRoute`로 보호, 인증 토큰을 포함한 API/WebSocket 호출.

## 3. 상태 관리 설계
- `AuthProvider` (Context + React Query)
  - 로컬 스토리지의 `authToken`을 초기화 시 복원.
  - `login`, `register`, `logout`, `refreshProfile` 제공.
  - `status`: `loading` | `authenticated` | `guest`.
- `ProtectedRoute`: 미인증 시 `/login`으로 리다이렉트, 로딩 상태에서는 안내 메시지.

## 4. API 연동
- `shared/api/client.ts`: 기본 `apiFetch` 헬퍼, Authorization 헤더 자동 주입, 에러는 `ApiError` 예외로 전달.
- `features/auth/api.ts`:
  - `POST /api/auth/register`
  - `POST /api/auth/login`
  - `POST /api/auth/logout`
  - `GET /api/users/me`
  - `PUT /api/users/me`
- 로비 페이지: `/api/games` 호출 시 토큰 필수.
- WebSocket: `WS_BASE_URL/ws/echo?token=<JWT>`로 연결.

## 5. 라우팅 및 네비게이션
- 공개: `/`, `/login`, `/register`.
- 보호: `/lobby`, `/game`, `/profile` → `ProtectedRoute` 래핑.
- 헤더 네비게이션: 인증 상태에 따라 로그인/회원가입 또는 프로필/로그아웃 버튼 노출, 닉네임 표시.

## 6. UI/UX 메모
- 한국어 카피로 모든 안내/버튼 제공.
- 오류/성공 메시지 색상: `.error`(적색), `.success`(녹색) 스타일 정의.
- 기본 배경/폰트는 v0.1.0 스타일을 유지하되 nav 버튼에 보조 스타일 추가.

## 7. 테스트 전략
- `AuthProvider.test.tsx`
  - 로그인 API 응답을 모킹해 인증 상태와 닉네임이 설정되는지 확인.
  - `ProtectedRoute`가 비인증 시 로그인 화면으로 이동하는지 검증.
- vitest + Testing Library + jsdom 환경, `src/test/setup.ts`에서 jest-dom 확장 로드.

## 8. 추후 작업(TODO)
- 로그인/회원가입 폼의 세부 검증 및 에러 코드별 메시지 분리.
- 프로필 이미지 업로드 UI 및 미리보기.
- React Query를 활용한 API 캐싱 고도화 및 글로벌 에러 핸들러 추가.
