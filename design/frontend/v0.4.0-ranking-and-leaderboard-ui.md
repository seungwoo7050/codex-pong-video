# v0.4.0 랭킹/리더보드 UI 설계

## 1. 목적 및 범위
- 일반전과 랭크전을 명확히 구분하는 로비 UI를 제공한다.
- 사용자 현재 레이팅/티어를 프로필과 로비에서 노출한다.
- 기본 리더보드 페이지를 추가해 상위 레이팅 사용자를 확인할 수 있게 한다.
- 실시간 게임 화면에서 랭크전 결과(레이팅 변동)를 안내한다.

## 2. 화면 구성
1. **로비 페이지**
   - "일반전" / "랭크전" 두 개의 매칭 버튼 제공, 대기 메시지는 각 큐별로 분리 관리.
   - 내 랭크 정보 카드: 현재 레이팅, 티어(`toTierLabel`) 표시.
   - 최근 경기 목록: `matchType` 뱃지, 랭크전일 경우 레이팅 변동(`ratingChangeA/B`) 함께 출력.
2. **프로필 페이지**
   - 기존 프로필 필드 + 현재 레이팅/티어 노출. 닉네임·아바타 수정 기능 유지.
3. **게임 페이지**
   - 상단 상태에 매치 타입(NORMAL/RANKED) 표시.
   - 랭크전 종료 시 WebSocket `ratingChange`를 받아 레이팅 변동 안내 메시지 출력.
4. **리더보드 페이지**
   - `/leaderboard` 보호 라우트. 상위 랭크 사용자 목록(순위, 닉네임, 레이팅, 티어, 아바타 URL) 표시.
   - 빈 데이터/에러 시 안내 메시지 제공.

## 3. 데이터 흐름
- **인증/프로필**: `UserProfile`에 `rating` 필드 추가. 로그인/회원가입/프로필 조회 모두 레이팅 값을 포함한다.
- **매칭**: `useQuickMatch(queueType)`가 `/api/match/quick`(일반) 또는 `/api/match/ranked`(랭크)를 호출. 응답의 `matchType`을 저장해 상태 메시지를 표시하고, 매칭 완료 시 `roomId`로 이동.
- **게임 실시간**: `useGameSocket`이 서버 메시지 `{type, snapshot, matchType, ratingChange?}`를 수신. `matchType` 상태를 UI에 노출하고, `ratingChange`로 랭크전 결과 메시지를 생성.
- **최근 경기 목록**: `/api/games` 응답에 포함된 `matchType`과 레이팅 변동 필드를 사용해 랭크전을 구분.
- **리더보드**: `/api/rank/leaderboard` 호출 결과를 `LeaderboardEntry` 리스트로 렌더링.

## 4. 티어 정책 (UI 전용)
- `toTierLabel(rating)`
  - 1800+: 플래티넘
  - 1600+: 골드
  - 1400+: 실버
  - 1200+: 브론즈
  - 그 외: 비기너 / null일 때 언랭크
- 서버 저장값은 레이팅 정수이며, 티어는 프런트에서 계산해 표시한다.

## 5. 상태 관리/라우팅
- `App.tsx`에 `/leaderboard` 라우트와 네비게이션 링크 추가.
- `ProtectedRoute`를 통해 로비/게임/프로필/리더보드 모두 인증된 사용자만 접근.
- React Query는 기존 인증 컨텍스트에서 사용, 매칭/리더보드는 `apiFetch` 단순 호출로 처리.

## 6. 테스트/확인 포인트
- 인증 후 로비에서 일반전/랭크전 버튼 각각 정상 동작, roomId 수신 시 게임 페이지로 이동.
- 랭크전 종료 후 게임 페이지에서 레이팅 변동 메시지 노출 확인(WebSocket `ratingChange`).
- 프로필 페이지에서 레이팅/티어가 표시되고 닉네임 수정 후에도 값 유지.
- 리더보드 페이지에서 상위 사용자가 정렬 순서대로 출력되고, 에러 시 안내 문구가 보이는지 확인.

## 7. 후속 과제
- 티어 배지/아이콘 디자인 보강.
- 리더보드 페이지네이션/검색, 개인 전적 상세 화면은 이후 버전에서 확장.
