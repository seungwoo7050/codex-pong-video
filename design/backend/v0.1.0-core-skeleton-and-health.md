# v0.1.0 백엔드 설계: 코어 스켈레톤 및 헬스체크

## 1. 목적 / 범위
- Spring Boot 기반 백엔드 프로젝트 골격을 마련한다.
- 헬스체크 및 테스트 게임 결과 저장용 최소 API를 제공한다.
- MariaDB 연동 및 Docker 빌드 경로를 정의한다.

## 2. 외부 동작
### 2.1 REST 엔드포인트
- `GET /api/health`
  - 응답: `{ status: "ok", service: "codex-pong-backend", now: "yyyy-MM-dd HH:mm:ss" }`
  - 용도: 인프라 헬스체크.
- `POST /api/games`
  - 요청 바디: `{ playerA, playerB, scoreA, scoreB }`
  - 검증: 이름 필수/50자 제한, 점수 0~30.
  - 응답: 생성된 경기 결과 DTO.
- `GET /api/games`
  - 응답: 경기 결과 목록.

### 2.2 데이터 모델
- `GameResult`
  - `id (PK)`, `playerA`, `playerB`, `scoreA`, `scoreB`, `playedAt`.
  - 현재는 단순 조회/저장만 수행하며, 랭킹/계정 연동은 후속 버전에서 다룸.

## 3. 내부 구조
- 패키지
  - `health`: 헬스체크 컨트롤러.
  - `game`: 엔티티, DTO, 서비스, 컨트롤러, WebSocket 핸들러.
  - `config`: WebSocket 설정.
- 구성 요소
  - `HealthController`: 단순 상태 반환.
  - `GameResultController`: 경기 생성/조회 API.
  - `GameResultService`: 입력 검증 및 저장 로직.
  - `GameResultRepository`: JPA CRUD.
  - `EchoWebSocketHandler`: WebSocket 에코 메시지.
  - `WebSocketConfig`: `/ws/echo` 경로를 핸들러에 매핑.

## 4. 데이터베이스 / 설정
- 기본 DB: MariaDB `codexpong` 스키마.
- `application.properties`
  - `spring.datasource.url=jdbc:mariadb://${DB_HOST:db}:3306/${DB_NAME:codexpong}`
  - `spring.jpa.hibernate.ddl-auto=update`
  - `spring.jackson.time-zone=Asia/Seoul`
- 테스트 프로파일
  - H2 메모리 DB, `ddl-auto=create-drop`.

## 5. 테스트 전략
- `HealthControllerTest`: `/api/health`가 `ok` 응답을 반환하는지 검증.
- `GameResultControllerTest`: 경기 생성 후 목록 조회가 동작하는지 검증.
- `CodexPongApplicationTests`: 컨텍스트 로드 확인.

## 6. 마이그레이션 / 향후 작업
- v0.2.0 이후 계정/인증 도입 시 엔티티에 작성자/사용자 식별자 추가.
- WebSocket 이벤트를 STOMP 기반 프로토콜로 확장 예정.
